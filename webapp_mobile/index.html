<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <title>NginxPulse - Mobile</title>
    <script src="/app-config.js"></script>
    <script>
      (function () {
        var location = window.location;
        var rawBase = String(window.__NGINXPULSE_BASE_PATH__ || '');
        var basePrefix = rawBase.trim();
        if (basePrefix) {
          if (!basePrefix.startsWith('/')) {
            basePrefix = '/' + basePrefix;
          }
          if (basePrefix.endsWith('/')) {
            basePrefix = basePrefix.slice(0, -1);
          }
        }
        var params = new URLSearchParams(location.search || '');
        var view = params.get('view');
        if (view !== 'desktop') {
          return;
        }
        var path = location.pathname || '/';
        if (basePrefix) {
          if (path === basePrefix) {
            return;
          }
          if (path.indexOf(basePrefix + '/') !== 0) {
            return;
          }
          path = path.slice(basePrefix.length) || '/';
        }
        var isMobilePath = path === '/m' || path.indexOf('/m/') === 0;
        if (!isMobilePath) {
          return;
        }
        var target = path === '/m' ? '/' : path.slice(2) || '/';
        if (basePrefix) {
          target = basePrefix + target;
        }
        if (location.search) {
          target += location.search;
        }
        if (location.hash) {
          target += location.hash;
        }
        if (target !== location.pathname + location.search + location.hash) {
          location.replace(target);
        }
      })();
    </script>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
